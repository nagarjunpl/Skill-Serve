<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register as Worker - SkillServe</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body data-page-title="register worker">
    <div class="container">
        <header class="header">
            <div class="logo">
                <h1>üîß SkillServe</h1>
                <p>Register as a Skilled Worker</p>
            </div>
        </header>

        <main class="register-container">
            <div class="register-card">
                <h2>Complete Your Worker Profile</h2>
                <p>Fill in your details to start receiving job requests</p>
                
                <form id="workerRegistrationForm">
                    <div class="form-group">
                        <label for="workerName" data-translate="name">Full Name</label>
                        <input type="text" id="workerName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="profession">Profession</label>
                        <select id="profession" required>
                            <option value="">Select your profession</option>
                            <option value="Electrician" data-translate="electrician">Electrician</option>
                            <option value="Plumber" data-translate="plumber">Plumber</option>
                            <option value="Painter" data-translate="painter">Painter</option>
                            <option value="Carpenter" data-translate="carpenter">Carpenter</option>
                            <option value="Mechanic" data-translate="mechanic">Mechanic</option>
                            <option value="Cleaner" data-translate="cleaner">Cleaner</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="experience" data-translate="years of experience">Years of Experience</label>
                        <select id="experience" required>
                            <option value="">Select experience</option>
                            <option value="1">Fresher</option>
                            <option value="1">1 year</option>
                            <option value="2">2 years</option>
                            <option value="3">3 years</option>
                            <option value="4">4 years</option>
                            <option value="5">5 years</option>
                            <option value="6">6-10 years</option>
                            <option value="10">10+ years</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="location" data-translate="location">Location</label>
                        <input type="text" id="location" placeholder="City, State" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="contact" data-translate="contact">Contact Number</label>
                        <input type="tel" id="contact" placeholder="(123) 456-7890" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="description">About You (Optional)</label>
                        <textarea id="description" rows="3" placeholder="Tell customers about your skills and experience..."></textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Register as Worker</button>
                </form>
                
                <div class="register-footer">
                    <p>Already registered? <a href="index.html" data-translate="login">Login here</a></p>
                    <!-- Language toggle for register page -->
                    <div style="margin-top: 1rem;">
                        <button id="registerLanguageToggle" class="btn language-toggle" onclick="toggleLanguage()">‡≤ï‡≤®‡≥ç‡≤®‡≤°</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="storage.js"></script>
    <script src="auth.js"></script>
    <script src="translator.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Check if user is logged in and is a worker
            const currentUser = getCurrentUser();
            if (!currentUser || currentUser.role !== 'worker') {
                window.location.href = 'index.html';
                return;
            }

            // Pre-fill name if available
            document.getElementById('workerName').value = currentUser.name;

            // Setup form submission
            document.getElementById('workerRegistrationForm').addEventListener('submit', handleRegistration);

            // Update language toggle button text
            const currentLang = getCurrentLanguage();
            const toggleBtn = document.getElementById('registerLanguageToggle');
            if (toggleBtn) {
                toggleBtn.innerHTML = currentLang === 'english' ? '‡≤ï‡≤®‡≥ç‡≤®‡≤°' : 'English';
                toggleBtn.title = currentLang === 'english' ? 'Switch to Kannada' : 'Switch to English';
            }
        });

        function handleRegistration(e) {
            e.preventDefault();
            
            const currentUser = getCurrentUser();
            const formData = new FormData(e.target);
            
            // Validate form
            const profession = document.getElementById('profession').value;
            const experience = document.getElementById('experience').value;
            const location = document.getElementById('location').value;
            const contact = document.getElementById('contact').value;
            const name = document.getElementById('workerName').value;
            
            if (!profession || !experience || !location || !contact || !name) {
                alert('Please fill in all required fields.');
                return;
            }

            // Create worker profile
            const worker = {
                id: Date.now().toString(),
                userId: currentUser.id,
                name: name,
                profession: profession,
                experience: experience,
                location: location,
                contact: contact,
                description: document.getElementById('description').value,
                available: true,
                createdAt: new Date().toISOString()
            };

            // Save worker to storage
            const workers = getWorkers();
            workers.push(worker);
            saveWorkers(workers);

            // Show success message
            showSuccessMessage();
        }

        function showSuccessMessage() {
            const form = document.getElementById('workerRegistrationForm');
            form.innerHTML = `
                <div class="success-message">
                    <div class="success-icon">‚úÖ</div>
                    <h3>Registration Successful!</h3>
                    <p>Your worker profile has been created successfully. You can now start receiving job requests from customers.</p>
                    <button class="btn btn-primary" onclick="goToDashboard()">Go to Dashboard</button>
                </div>
            `;
        }

        function goToDashboard() {
            window.location.href = 'worker-dashboard.html';
        }
    </script>
</body>
</html>
